fileVersion: 1
id: 44664235-0e69-4d76-9c54-ed338b987496
name: STG_FCT_ORDERS_10
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9769d864-97a5-474b-8ac6-cf67b933dc59
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2cc946dd-b651-4826-9887-e2eb28d65682
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 9f5c849b-1a46-4490-8a98-4a46e0047bcf
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 5f059006-f155-4770-b60a-7e5ec7210024
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 756d4340-d522-4018-bf1c-7f4b27aef603
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6e2dd6e3-c9e1-49f6-a7ab-bae9884ebf90
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 0baafa89-963d-44cd-9387-b09a009d6eca
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: ORDER_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 53e0263d-1184-400e-81a2-cf0e66c0becd
                stepCounter: 10031871-1ad9-4a3c-8f94-ebf0ab4eb5db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b5a1e90-e6a7-456e-9cfa-613dee146fef
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4be7ccc3-70ca-4c79-99e7-424bced8f58d
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 800463aa-40da-46cf-810d-6194c500b2b1
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        hashColumns: []
        hashDetails: null
        name: ORDER_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a502f5ac-a80d-4d3d-b874-713bee0726a7
                stepCounter: 10031871-1ad9-4a3c-8f94-ebf0ab4eb5db
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8851e845-3035-477a-9494-aa838257356c
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6622826a-7735-409d-b6aa-1fc3d7cd3d35
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: a8f73a68-2568-4d74-bb9e-dd198a02767d
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a3f5702f-dbc2-4263-a5dd-47b91b2edb30
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5d652499-909e-4e5e-baa9-7e3143e1d2e3
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4d9522a3-69cf-42d7-9d61-0d1ede239f84
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 74568e7e-2053-48fc-8297-4b3085e1b61b
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: DATE
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dfd7a852-5198-41bd-b5d8-8a4807206900
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 98d2dcf0-7d56-4a0d-8125-fc736e27fa44
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: DATE
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b66d9a92-50c5-45d2-a416-d9be48910972
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 97734914-5af3-42e7-89fa-ed8bb8766eb4
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: DATE
        description: ""
        hashColumns: []
        hashDetails: null
        name: LINEITEM_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddba660c-0f7a-47fc-a8e4-215582dc9f2f
                stepCounter: b9060276-6559-429a-b128-29cbb932f97c
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 8109d336-3904-496d-8453-57961bb70e2d
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: DATE
        description: ""
        hashColumns: []
        hashDetails: null
        name: ORDER_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 4c77b313-4a05-46c8-b00a-8de7e78d75bc
                stepCounter: 10031871-1ad9-4a3c-8f94-ebf0ab4eb5db
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 5a787eae-bae1-478b-8ff6-94ab433f32c5
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Calculated column that counts total orders, not lines in orders
        keyColumnType: None
        name: CALC_ORDER_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: CASE WHEN "V_LINEITEM"."LINEITEM_LINENUMBER" = 1 THEN 1 ELSE 0 END
        systemColumnType: None
        transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 83b9c128-c3a8-4659-a7ec-44280ddf06cf
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER(12,2)
        description: Calculated column that only displays total price once per order
        hashColumns: []
        hashDetails: null
        name: CALC_ORDER_TOTAL_PRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a27b0211-a0a9-479e-991a-052d6c7a0fb4
                stepCounter: 10031871-1ad9-4a3c-8f94-ebf0ab4eb5db
            transform: CASE WHEN "V_LINEITEM"."LINEITEM_LINENUMBER" = 1 THEN "V_ORDERS"."ORDER_TOTALPRICE" ELSE 0 END
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 27099763-ca0f-493b-91e9-f4af42be0bac
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Calculated column used for analytucs tools that require a factless fact
        keyColumnType: None
        name: CALC_COUNT
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "1"
        systemColumnType: None
        transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: b2c78812-f33e-43ec-a88a-c76c5fbba91b
          stepCounter: 44664235-0e69-4d76-9c54-ed338b987496
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: Calculated column that displays days to ship
        keyColumnType: None
        name: CALC_DAYS_TO_SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: "\"V_LINEITEM\".LINEITEM_SHIPDATE - \"V_ORDERS\".\"ORDER_ORDERDATE\""
        systemColumnType: None
        transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          V_LINEITEM: b9060276-6559-429a-b128-29cbb932f97c
          V_ORDERS: 10031871-1ad9-4a3c-8f94-ebf0ab4eb5db
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: V_LINEITEM
          - locationName: WORK
            nodeName: V_ORDERS
        join:
          joinCondition: |
            FROM {{ ref('WORK', 'V_LINEITEM') }} "V_LINEITEM"
            LEFT JOIN {{ ref('WORK', 'V_ORDERS') }} "V_ORDERS"
            ON "V_LINEITEM"."LINEITEM_ORDERKEY" = "V_ORDERS"."ORDER_ORDERKEY"
        name: STG_FCT_ORDERS_10
        noLinkRefs: []
  name: STG_FCT_ORDERS_10
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
